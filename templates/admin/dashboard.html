{% extends '_base.html' %}
{% block content %}
  <h2>Painel Administrativo</h2>
  <div class="admin-grid">
    <section>
      <h3>Seções</h3>
      <a class="btn" href="{{ url_for('sections.admin_section_new') }}">Nova Seção</a>
      <ul>
        {% for s in sections %}
          <li>{{ s.title }} — <a href="{{ url_for('sections.admin_section_edit', sid=s.id) }}">editar</a>
          <form method="post" action="{{ url_for('sections.admin_section_delete', sid=s.id) }}" style="display:inline">
            <button class="link-like" type="submit">remover</button>
          </form>
          </li>
        {% endfor %}
      </ul>
    </section>

    <section>
      <h3>Textos recentes</h3>
      <a class="btn" href="{{ url_for('texts.admin_text_new') }}">Novo Texto</a>
      <ul>
        {% for t in texts %}
          <li>{{ t.title }} — <a href="{{ url_for('texts.admin_text_edit', tid=t.id) }}">editar</a>
          <form method="post" action="{{ url_for('texts.admin_text_delete', tid=t.id) }}" style="display:inline">
            <button class="link-like" type="submit">remover</button>
          </form>
          </li>
        {% else %}
          <li>Sem textos ainda.</li>
        {% endfor %}
      </ul>
    </section>
  </div>

    <section>
      <h3>Textos da semana</h3>
      <a class="btn" href="{{ url_for('admin.admin_weekly_text') }}">Gerenciar Texto da Semana</a>
    </section>
  </div>

    <h2>Contatos Recebidos</h2>
  {% if contacts %}
    <table class="data-table">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Email</th>
          <th>Mensagem</th>
          <th>Data</th>
          <th>Status</th>
          <th>Ação</th>
        </tr>
      </thead>
      <tbody>
        {% for c in contacts %}
        <tr class="{{ 'responded' if c.responded }}">
          <td>{{ c.name }}</td>
          <td>{{ c.email }}</td>
          <td style="max-width: 400px;">{{ c.message }}</td>
          <td>{{ c.created_at.strftime('%d/%m/%Y %H:%M') }}</td>
          <td>
            {% if c.responded %}
              <span class="badge badge-success">Respondido</span>
            {% else %}
              <span class="badge badge-warning">Pendente</span>
            {% endif %}
          </td>
          <td>
            {% if not c.responded %}
              <form method="post" action="{{ url_for('admin.admin_contact_responded', cid=c.id) }}">
                <button class="btn alt" type="submit">Marcar como respondido</button>
              </form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Nenhum contato recebido ainda.</p>
  {% endif %}

{% endblock %}
